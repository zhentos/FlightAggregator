
Демонстрация запуска API и его работы:
https://www.loom.com/share/89858ded7b324f8897dfabd3bc215ec0

НЕКОТОРЫЕ ДОПУЩЕНИЯ:

	1. Так как это демо-приложение, то строку подключения к базе данных, 
	а также другие конфигурационные настройки я оставляю в  .appsettings файле.
	На реальном проекте важная информация помещалась бы в User Secrets и вычитывалась бы оттуда.

	2. В реальной системе у нас бы использовались очереди сообщений для ресурсоемких операций,
	в данном приложении, например, для отправки имейла об успешной оплате билета и сведений о полете.
	
	3. В техническом задании ничего не сказано про интеграцию с платежными системами,
	поэтому данный пункт не рассматривается в реализации. Операцию по отправке платежей выполнял бы отдельный сервис.

	4. Требований к контейнеризации (Docker) и оркестрации (Kubernates) в техническом задании нет,
	поэтому приложение не было упаковано в контейнер. В реальной системе нам бы понадобился балансировщик нагрузки, репликация
	или шердинг БД, горизонтальное масштабирование сервисов.

	5. Я не используем средства маппинга(Automapper) моделей для простоты и ускорения процесса разработки
	Для логирования событий был использован  стандартный Microsoft.Extensions.Logging.Ilogger  интерфейс.
	В реальном приложении, я допускаю, что мы использовали бы связку, например, Rancher (Docker + Kubernetes).
	На моем предыдущем проекте, логи писались в консоль, с помощью Rancher -панели их можно было посмотреть в реальном времени,
	а весь стрим логов отравлялся в ElasticSearch. Оттуда можно было доставать логи, используя необходимые фильтры.
	Так же в приложениях я подключал поддержку Sentry (https://sentry.io/) - удобная отправка логов в сервис,
	с возможностью отправки нотификаций группе юзеров на email или telegramm, если что-то упало в системе.

	6. Снятие метрик и построение графиков тоже не входит в тех. задание. Но на предудущем проекте я использовал Grafana + Prometeus
	для снятия стандартных и имплементации кастомных метрик, и построения дашбордов, для наиболее важных из них. 

	КРАТКОЕ ОПИСАНИЕ РЕАЛИЗАЦИИ:

	1. Для демо-приложения была выбрана простейшая слоеная архитектура. 
	Solution состоит из 5-ти проектов: Web API, Модели и DTO, Репозитории, Сервисы и Тесты
	Дополнительно прилагаются файлы базы данных DB/flights.mdf и скрипт формирования этих самых
	тестовых данных Models/SQL/PopulateDB.sql

	2. В проекте репозиториев осуществляется доступ к базе данных и реализация соответствующих методов. 
	В качестве ORM-механизма я выбрал Dapper.

	3.В проекте Services помещена основная логика для эмуляции работы приложения-агрегатора авиабилетов.
	Для тестовых целей я определил общий интерфейс IFlightProvidersService который должны реализовать все провайдеры данных,
	в нашем случае я создал 3 таковых: Белавиа, Аэрофлот, Аврора. Т.к. одним из условий тех. задания было поставлена задача 
	добавления новых поставщиков услуг без сильной переработки кода, введение данного общего интерфейса должно ее решить.

	Ввиду того, что разнообразных открытых сервисов , которые бы возвращали json-ответ с авиаперелетами я не нашел, было принято
	решение создать базу данных с 3мя компаниями, которые предоставляют перелеты по определенным направлениям. Каждый из 3х
	сервисов-провайдеров (AeroflotFlightsService, AuroraFlightsService, BelaviaFlightsService) эмулирует отдачу авиаперелетов по 
	заданным поисковым параметрам.

	Так же одним из услових тех. задания являлась возможность резервирования авиаперелета. В данной демо-системе оно осуществляется
	отдельным запросом, и на уровне базы данных, для конкретного провайдера выставляется значение резервирования перелета 
	(flag IsAvailable) выставляется в false.

	Общую логика работы поиска и резервации перелетов представлена в FlightsAggregatorService. Там у нас есть и механизм валидации, 
	и работы с кэшем. Для простоты реализации был использован IMemoryCache.

	4. Проект Web API предоставляет возможность обратиться к 2м action's контроллера FlightController. Оба эндпоинта
	данного контроллера документированы. В проект добавлена интеграция со Swagger. 

	5. В проекте Tests представлено несколько Unit-тестов для контроллера и одного из сервисов, согласно условиям тех.задания.

	ПРИМЕРЫ ЗАПРОСОВ И ОТВЕТОВ от API:

	REQUEST:

	curl -X 'POST' \
	  'https://localhost:7272/Flight/search' \
	  -H 'accept: text/plain' \
	  -H 'Content-Type: application/json' \
	  -d '{
	  "from": "Minsk",
	  "to": "Moskva",
	  "flightDate": "2024-04-22"
	}'

	RESPONSE BODY:
	
	[
	  {
		"companyId": 2,
		"companyName": "Aeroflot",
		"from": "Minsk",
		"to": "Moskva",
		"flightDate": "2024-04-22T00:00:00",
		"isAvailable": true
	  },
	  {
		"companyId": 3,
		"companyName": "Aurora",
		"from": "Minsk",
		"to": "Moskva",
		"flightDate": "2024-04-22T00:00:00",
		"isAvailable": true
	  }
	]

    curl -X 'POST' \
	  'https://localhost:7272/Flight/book' \
	  -H 'accept: text/plain' \
	  -H 'Content-Type: application/json' \
	  -d '{
	  "companyId": 1,
	  "flightId": 2
	}'

	RESPONSE BODY:
	true